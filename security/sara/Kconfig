menu S.A.R.A.

config SECURITY_SARA
	bool "Enable S.A.R.A."
	depends on SECURITY
	select SECURITYFS
	default n
	help
	  This selects S.A.R.A. LSM which aims to collect heterogeneous
	  security measures providing a common interface to manage them.
	  This LSM will always be stacked with the selected primary LSM and
	  other stacked LSMs.
	  Further information can be found in Documentation/security/SARA.rst.

	  If unsure, answer N.

config SECURITY_SARA_DEFAULT_DISABLED
	bool "S.A.R.A. will be disabled at boot."
	depends on SECURITY_SARA
	default n
	help
	  If you say Y here, S.A.R.A. will not be enabled at startup. You can
	  override this option at boot time via "sara=[1|0]" kernel parameter
	  or via user-space utilities.
	  This option is useful for distro kernels.

	  If unsure, answer N.

config SECURITY_SARA_NO_RUNTIME_ENABLE
	bool "S.A.R.A. can be turn on only at boot time."
	depends on SECURITY_SARA_DEFAULT_DISABLED
	default y
	help
	  By enabling this option it won't be possible to turn on S.A.R.A.
	  at runtime via user-space utilities. However it can still be
	  turned on at boot time via the "sara=1" kernel parameter.
	  This option is functionally equivalent to "sara=0" kernel parameter.
	  This option is useful for distro kernels.

	  If unsure, answer Y.

config SECURITY_SARA_USB_FILTERING
	bool "USB Filtering"
	depends on SECURITY_SARA && USB_SUPPORT
	default y
	help
	  Enable S.A.R.A. USB filtering capability. To prevent the connection
	  of unwanted USB devices, e.g. custom USB devices designed to
	  exploit vulnerabilities found in device drivers.
	  User-space utilities can be used to manage the configuration file.
	  Further information can be found in Documentation/security/SARA.rst.

	  If unsure, answer Y.

config SECURITY_SARA_USB_FILTERING_DENY
	bool "Default action for new USB devices is DENY"
	depends on SECURITY_SARA_USB_FILTERING
	default n
	help
	  If you say Y here any device that is not explicitly allowed via the
	  configuration will be blocked. If you don't enable this option
	  any USB device connected at boot will be allowed, regardless of
	  your settings. However, if you enable this and you don't
	  set your user-space utilities adequately your machine could become
	  unusable (e.g. your USB keyboard will be disabled).
	  This option can be overridden at boot time via
	  "sara_usb_filtering_default=[d|a]" kernel parameter.

	  If unsure, answer N.

config SECURITY_SARA_USB_FILTERING_DISABLED
	bool "USB filtering will be disabled at boot."
	depends on SECURITY_SARA_USB_FILTERING
	default n
	help
	  If you say Y here USB filtering won't be enabled at startup. You can
	  override this option via user-space utilities or at boot time via
	  "sara_usb_filtering=[0|1]" kernel parameter.
	  This option is useful for distro kernels.

	  If unsure, answer N.

endmenu
