# tproxy
inet x y 
  [ tproxy tproxy inet ]

# tproxy to 192.0.2.1
inet x y 
  [ immediate reg 1 0x010200c0 ]
  [ tproxy tproxy ip addr reg 1 ]

# tproxy to [2001:db8::1]
inet x y 
  [ immediate reg 1 0xb80d0120 0x00000000 0x00000000 0x01000000 ]
  [ tproxy tproxy ip6 addr reg 1 ]

# meta l4proto tcp tproxy to :50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0x0000a0c3 ]
  [ tproxy tproxy inet port reg 1 ]

# meta l4proto tcp tproxy to 192.0.2.1:50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0x010200c0 ]
  [ immediate reg 2 0x0000a0c3 ]
  [ tproxy tproxy ip addr reg 1 port reg 2 ]

# meta l4proto tcp tproxy to [2001:db8::1]:50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0xb80d0120 0x00000000 0x00000000 0x01000000 ]
  [ immediate reg 2 0x0000a0c3 ]
  [ tproxy tproxy ip6 addr reg 1 port reg 2 ]

# meta l4proto 6 tproxy to :50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0x0000a0c3 ]
  [ tproxy tproxy inet port reg 1 ]

# meta l4proto 6 tproxy to 192.0.2.1:50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0x010200c0 ]
  [ immediate reg 2 0x0000a0c3 ]
  [ tproxy tproxy ip addr reg 1 port reg 2 ]

# meta l4proto 6 tproxy to [2001:db8::1]:50080
inet x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x00000006 ]
  [ immediate reg 1 0xb80d0120 0x00000000 0x00000000 0x01000000 ]
  [ immediate reg 2 0x0000a0c3 ]
  [ tproxy tproxy ip6 addr reg 1 port reg 2 ]
